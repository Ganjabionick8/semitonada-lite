<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>SemitONada Lite - Campo Harm√¥nico Completo</title>
<style>
  body {
    background:#0d0d0d;
    color:#0ff;
    font-family: monospace, monospace;
    padding:1rem;
    text-align:center;
    user-select:none;
    margin:0;
    display: flex;
    flex-direction: column;
    min-height: 100vh;
  }
  h1 {
    font-size:1.4rem;
    margin-bottom:1rem;
  }
  #modo-toggle, #tones {
    display:flex;
    justify-content:center;
    gap:0.3rem;
    margin-bottom:1rem;
    flex-wrap: wrap;
  }
  button {
    background:#111;
    border:1.5px solid #0ff;
    border-radius:5px;
    color:#0ff;
    padding:0.25rem 0.5rem;
    cursor:pointer;
    min-width:40px;
    font-size:0.9rem;
    user-select:none;
  }
  button.active {
    background:#0ff;
    color:#000;
    font-weight:bold;
  }
  #graus-container {
    display:flex;
    justify-content:center;
    gap:0.7rem;
    flex-wrap: wrap;
  }
  .grau-coluna {
    display:flex;
    flex-direction: column;
    align-items:center;
    min-width:65px;
  }
  .grau-label {
    font-weight:bold;
    margin-bottom:0.2rem;
  }
  .nota {
    background:#111;
    border:1px solid #0ff;
    border-radius:5px;
    padding:0.3rem 0.5rem;
    width:100%;
  }
  #acorde-selecionado {
    margin-top:1rem;
    font-weight:bold;
    min-height:1.8rem;
  }
  .apoie {
    margin-top: 2rem;
    font-size: 0.9rem;
    color: #66ffffcc;
    line-height: 1.3;
  }
  .apoie p {
    margin: 0.2rem 0;
  }
  .apoie p.pix {
    font-weight: 700;
    cursor: pointer;
    user-select: text;
  }
  .apoie p.pix:hover {
    color: #33ffff;
  }
  footer {
    margin-top: auto;
    background: #111;
    color: #0ff;
    font-size: 0.8rem;
    padding: 0.7rem 0.5rem;
    user-select: text;
  }
  footer a {
    color: #0ff;
    text-decoration: none;
    font-weight: bold;
    margin: 0 0.3rem;
  }
  footer a:hover {
    text-decoration: underline;
  }
</style>
</head>
<body>

<h1>SemitONada Lite - Campo Harm√¥nico</h1>

<div id="modo-toggle">
  <button id="btnGeral" class="active" aria-pressed="true">Geral</button>
  <button id="btnIndividual" aria-pressed="false">Individual</button>
</div>

<div id="tones" role="list" aria-label="Sele√ß√£o de tom"></div>

<div id="graus-container" role="list" aria-label="Graus do campo harm√¥nico"></div>

<div id="acorde-selecionado" style="display:none;" aria-live="polite"></div>

<div class="apoie" role="contentinfo" aria-label="Se√ß√£o para apoio ao projeto">
  <p>Se curtir o SemitONada, considere apoiar üôè</p>
  <p class="pix" id="pixKey" tabindex="0" title="Clique para copiar PIX">PIX: <strong>biel.simeone@gmail.com</strong></p>
  <p>Qualquer valor ajuda muito no desenvolvimento!</p>
  <p>Obrigado por apoiar! üíúüé∂</p>
</div>

<footer>
  <p>
    <a href="https://www.instagram.com/ganjabionick8" target="_blank" rel="noopener noreferrer">Instagram</a> |
    <a href="https://github.com/Ganjabionick8" target="_blank" rel="noopener noreferrer">GitHub</a>
  </p>
</footer>

<script>
const campos = {
  'C':  ['C',  'Dm',  'Em',  'F',  'G',  'Am',  'Bdim'],
  'C#': ['C#', 'D#m', 'E#m', 'F#', 'G#', 'A#m', 'B#dim'],
  'Db': ['Db', 'Ebm', 'Fm',  'Gb', 'Ab', 'Bbm', 'Cdim'],
  'D':  ['D',  'Em',  'F#m', 'G',  'A',  'Bm',  'C#dim'],
  'D#': ['D#', 'Fm',  'Gm',  'G#', 'A#', 'Cm',  'Ddim'],
  'Eb': ['Eb', 'Fm',  'Gm',  'Ab', 'Bb', 'Cm',  'Ddim'],
  'E':  ['E',  'F#m', 'G#m', 'A',  'B',  'C#m', 'D#dim'],
  'F':  ['F',  'Gm',  'Am',  'A#', 'C',  'Dm',  'Edim'],
  'F#': ['F#', 'G#m', 'A#m', 'B',  'C#', 'D#m', 'E#dim'],
  'Gb': ['Gb', 'Abm', 'Bbm', 'Cb', 'Db', 'Ebm', 'Fdim'],
  'G':  ['G',  'Am',  'Bm',  'C',  'D',  'Em',  'F#dim'],
  'G#': ['G#', 'A#m', 'Cm',  'C#', 'D#', 'Fm',  'Gdim'],
  'Ab': ['Ab', 'Bbm', 'Cm',  'Db', 'Eb', 'Fm',  'Gdim'],
  'A':  ['A',  'Bm',  'C#m', 'D',  'E',  'F#m', 'G#dim'],
  'A#': ['A#', 'Cm',  'Dm',  'D#', 'F',  'Gm',  'Adim'],
  'Bb': ['Bb', 'Cm',  'Dm',  'Eb', 'F',  'Gm',  'Adim'],
  'B':  ['B',  'C#m', 'D#m', 'E',  'F#', 'G#m', 'A#dim']
};

const graus = ['I','II','III','IV','V','VI','VII'];

let tomAtual = null;
let grauAtual = null;
let modo = 'geral';

const tonesDiv = document.getElementById('tones');
const grausContainer = document.getElementById('graus-container');
const acordeSel = document.getElementById('acorde-selecionado');
const pixKey = document.getElementById('pixKey');

function criarBotoesTons() {
  tonesDiv.innerHTML = '';
  Object.keys(campos).forEach(tom => {
    const btn = document.createElement('button');
    btn.textContent = tom;
    btn.setAttribute('role','listitem');
    btn.onclick = () => {
      tomAtual = tom;
      grauAtual = null;
      mostrar();
    };
    tonesDiv.appendChild(btn);
  });
}

function criarGraus() {
  grausContainer.innerHTML = '';
  graus.forEach((g, i) => {
    const col = document.createElement('div');
    col.className = 'grau-coluna';
    col.setAttribute('role','listitem');
    const label = document.createElement('div');
    label.className = 'grau-label';
    label.textContent = g;
    const notaDiv = document.createElement('div');
    notaDiv.className = 'nota';
    notaDiv.id = 'nota-' + i;
    notaDiv.textContent = '-';
    col.appendChild(label);
    col.appendChild(notaDiv);
    grausContainer.appendChild(col);
  });
}

function atualizarNotasGeral() {
  if (!tomAtual) return;
  campos[tomAtual].forEach((acorde, i) => {
    const notaDiv = document.getElementById('nota-' + i);
    if (notaDiv) notaDiv.textContent = acorde;
  });
}

function limparNotas() {
  for(let i=0; i<graus.length; i++){
    const notaDiv = document.getElementById('nota-' + i);
    if (notaDiv) notaDiv.textContent = '-';
  }
}

document.getElementById('btnGeral').onclick = () => {
  modo = 'geral';
  grauAtual = null;
  mostrar();
  atualizarAriaPressed();
};

document.getElementById('btnIndividual').onclick = () => {
  modo = 'individual';
  grauAtual = null;
  mostrar();
  atualizarAriaPressed();
};

function atualizarAriaPressed(){
  document.getElementById('btnGeral').setAttribute('aria-pressed', modo === 'geral');
  document.getElementById('btnIndividual').setAttribute('aria-pressed', modo === 'individual');
}

function mostrar() {
  document.querySelectorAll('#modo-toggle button').forEach(b => b.classList.remove('active'));
  document.getElementById(modo === 'geral' ? 'btnGeral' : 'btnIndividual').classList.add('active');

  acordeSel.style.display = 'none';

  if (!tomAtual) {
    limparNotas();
    return;
  }

  criarGraus();

  if (modo === 'geral') {
    atualizarNotasGeral();
  } else {
    limparNotas();
    acordeSel.style.display = 'block';
    acordeSel.textContent = 'Clique num grau';
    grausContainer.querySelectorAll('.grau-coluna').forEach((col, i) => {
      col.style.cursor = 'pointer';
      col.onclick = () => {
        grauAtual = i;
        mostrarIndividual();
      };
    });
  }
}

function mostrarIndividual() {
  if (grauAtual === null || !tomAtual) return;
  limparNotas();
  const notaDiv = document.getElementById('nota-' + grauAtual);
  if (notaDiv) notaDiv.textContent = campos[tomAtual][grauAtual];
  acordeSel.textContent = `${graus[grauAtual]}: ${campos[tomAtual][grauAtual]}`;
}

pixKey.onclick = () => {
  copiarPix();
};
pixKey.addEventListener('keypress', e => {
  if(e.key === 'Enter' || e.key === ' ') {
    e.preventDefault();
    copiarPix();
  }
});

function copiarPix() {
  const pix = pixKey.textContent.replace('PIX: ', '').trim();
  navigator.clipboard.writeText(pix).then(() => {
    pixKey.textContent = "PIX copiado! üôè";
    setTimeout(() => {
      pixKey.textContent = "PIX: biel.simeone@gmail.com";
    }, 2000);
  }).catch(() => {
    alert('Erro ao copiar PIX. Copie manualmente: biel.simeone@gmail.com');
  });
}

criarBotoesTons();
tomAtual = 'C';
mostrar();
atualizarAriaPressed();
</script>

</body>
</html>
